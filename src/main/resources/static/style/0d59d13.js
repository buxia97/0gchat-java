(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{712:function(e,t,n){"use strict";n.r(t);n(49),n(39),n(48),n(15),n(79),n(32),n(80);var r=n(30),c=(n(59),n(25),n(58),n(81));function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var l={props:{msgList:{type:Array,default:function(){return[]}}},data:function(){return{userKey:null}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(c.b)({userInfo:function(e){return e.userInfo},token:function(e){return e.token}})),watch:{userInfo:function(e,t){var n=this;null!=n.userInfo&&(n.userKey=n.userInfo.userKey)}},mounted:function(){var e=this;null!=e.userInfo&&(e.userKey=e.userInfo.userKey)},methods:{formatDate:function(e){return(e=new Date(parseInt(1e3*e))).getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)},replaceNewlinesWithBr:function(text){return text.replace(/\n/g,"<br>")},banIp:function(e){var t=this,n=this;n.$confirm("确认要封禁"+e.ip+"吗？","操作提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var data={ip:e.ip,chatid:e.chatid,token:n.token},r=t.$loading({lock:!0,spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});n.$axios.$post(n.$api.banUser(),t.qs.stringify(data),{progress:!1}).then((function(e){r.close(),1==e.code?n.$message({message:"操作成功！",type:"success"}):n.$message({message:e.msg,type:"error"})})).catch((function(e){r.close(),console.log(e),n.$message({message:"接口请求异常，请检查网络！",type:"error"})}))})).catch((function(){}))},deleteMsg:function(e){var t=this,n=this;n.$confirm("确认要删除该消息吗？","操作提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var data={key:e,token:n.token},r=t.$loading({lock:!0,spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});n.$axios.$post(n.$api.msgDelete(),t.qs.stringify(data),{progress:!1}).then((function(e){r.close(),1==e.code?n.$message({message:"操作成功！",type:"success"}):n.$message({message:e.msg,type:"error"})})).catch((function(e){r.close(),console.log(e),n.$message({message:"接口请求异常，请检查网络！",type:"error"})}))})).catch((function(){}))},reply:function(e){this.$parent.replyJson=e}}},f=l,m=n(57),component=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"msg"},[t("el-scrollbar",{ref:"msgScroll",staticStyle:{height:"100%"}},e._l(e.msgList,(function(n,r){return t("div",{staticClass:"msg-box",class:e.userKey==n.userKey?"my":""},[2!=n.type?[t("div",{staticClass:"msg-main"},[t("div",{staticClass:"msg-avatar"},[t("el-image",{attrs:{src:"/avatar/"+n.avatar+".webp"}})],1),e._v(" "),t("div",{staticClass:"msg-concent"},[t("div",{staticClass:"msg-concent-value"},[t("span",{staticClass:"mag-userName"},[e._v(e._s(n.userName))]),e._v(" "),t("span",{staticClass:"mag-postTime"},[e._v(e._s(e.formatDate(n.created)))]),e._v(" "),t("span",{staticClass:"reply",on:{click:function(t){return e.reply(n)}}},[e._v("回复")])]),e._v(" "),t("div",{staticClass:"msg-concent-text"},[0==n.type?[t("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(e.replaceNewlinesWithBr(n.text))}})]:e._e(),e._v(" "),3==n.type?[t("div",{staticClass:"msg-text"},[t("a",{attrs:{href:n.url}},[t("i",{staticClass:"el-icon-link"}),e._v(e._s(n.text))])])]:e._e(),e._v(" "),n.replyJSon&&0==n.type?t("div",{staticClass:"msg-reply"},[t("div",{staticClass:"reply-text"},[1==n.replyJSon.isDeleted?[e._v("\n                  消息已删除\n                ")]:[0==n.replyJSon.type?[e._v("\n                    "+e._s(n.replyJSon.text)+"\n                  ")]:e._e(),e._v(" "),3==n.replyJSon.type?[t("a",{attrs:{href:n.url}},[t("i",{staticClass:"el-icon-link"}),e._v(e._s(n.text))])]:e._e()]],2)]):e._e(),e._v(" "),""!=e.token?t("div",{staticClass:"msg-system-btn"},[t("span",{on:{click:function(t){return e.banIp(n)}}},[e._v("封禁")]),e._v(" "),t("span",{on:{click:function(t){return e.deleteMsg(n.id)}}},[e._v("删除")])]):e._e()],2)])])]:e._e(),e._v(" "),2==n.type?[t("div",{staticClass:"msg-system"},[t("div",{staticClass:"msg-system-text"},[e._v("\n        "+e._s(n.userName)+" : "+e._s(n.text)+"\n        ")])])]:e._e()],2)})),0)],1)}),[],!1,null,null,null);t.default=component.exports}}]);